<!DOCTYPE html>
<html lang="de-CH">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathe-Meister â€“ Lern-App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600&display=swap');
        body { font-family: 'Lexend', sans-serif; }
        .grade-card:hover svg { transform: scale(1.1); transition: transform 0.3s ease; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen flex items-center justify-center p-4">

    <div id="app" class="max-w-2xl w-full bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-100">
        </div>

    <script>
        const state = {
            view: 'start', // start, game, result
            grade: 1,
            questions: [],
            currentQuestionIndex: 0,
            score: 0,
            userAnswers: []
        };

        const icons = {
            1: '<svg class="w-16 h-16 text-blue-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>', // Plus
            2: '<svg class="w-16 h-16 text-emerald-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 12h8"/></svg>', // Kreis/Minus
            3: '<svg class="w-16 h-16 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg>', // Mal
            4: '<svg class="w-16 h-16 text-purple-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="6" r="1"/><circle cx="12" cy="18" r="1"/><path d="M5 12h14"/></svg>', // Geteilt
            5: '<svg class="w-16 h-16 text-rose-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1-2.5-2.5z"/><path d="M8 7h6"/></svg>', // Buch
            6: '<svg class="w-16 h-16 text-indigo-600" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>' // WÃ¼rfel/Komplex
        };

        function generateQuestions(grade) {
            const qs = [];
            for (let i = 0; i < 10; i++) {
                let a, b, op, ans;
                const r = Math.random();

                if (grade === 1) {
                    op = r > 0.5 ? '+' : '-';
                    a = Math.floor(Math.random() * 15) + 5;
                    b = Math.floor(Math.random() * a);
                    ans = op === '+' ? a + b : a - b;
                } else if (grade === 2) {
                    op = r > 0.5 ? '+' : '-';
                    a = Math.floor(Math.random() * 80) + 10;
                    b = Math.floor(Math.random() * 20) + 5;
                    ans = op === '+' ? a + b : a - b;
                } else if (grade === 3) {
                    const ops = ['+', '-', '*'];
                    op = ops[Math.floor(Math.random() * ops.length)];
                    if (op === '*') {
                        a = Math.floor(Math.random() * 10) + 1;
                        b = Math.floor(Math.random() * 10) + 1;
                    } else {
                        a = Math.floor(Math.random() * 500) + 100;
                        b = Math.floor(Math.random() * 400);
                    }
                    ans = op === '+' ? a + b : (op === '-' ? a - b : a * b);
                } else {
                    const ops = ['+', '-', '*', '/'];
                    op = ops[Math.floor(Math.random() * ops.length)];
                    if (op === '/') {
                        b = Math.floor(Math.random() * 10) + 1;
                        ans = Math.floor(Math.random() * 12) + 1;
                        a = b * ans;
                    } else if (op === '*') {
                        a = Math.floor(Math.random() * 15) + 2;
                        b = Math.floor(Math.random() * 15) + 2;
                        ans = a * b;
                    } else {
                        a = Math.floor(Math.random() * 2000) + 500;
                        b = Math.floor(Math.random() * 1500);
                        ans = op === '+' ? a + b : a - b;
                    }
                }
                qs.push({ a, b, op, ans });
            }
            return qs;
        }

        function render() {
            const app = document.getElementById('app');
            
            if (state.view === 'start') {
                app.innerHTML = `
                    <div class="p-8 text-center">
                        <h1 class="text-3xl font-bold text-slate-800 mb-2">Mathe-Meister</h1>
                        <p class="text-slate-500 mb-8">WÃ¤hle deine Klasse, um zu starten!</p>
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                            ${[1,2,3,4,5,6].map(g => `
                                <button onclick="startGame(${g})" class="grade-card p-6 border-2 border-slate-100 rounded-2xl hover:border-blue-400 hover:bg-blue-50 transition-all flex flex-col items-center gap-3">
                                    ${icons[g]}
                                    <span class="font-semibold text-slate-700">${g}. Klasse</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (state.view === 'game') {
                const q = state.questions[state.currentQuestionIndex];
                app.innerHTML = `
                    <div class="p-8">
                        <div class="flex justify-between items-center mb-8">
                            <span class="text-sm font-medium text-slate-400">Aufgabe ${state.currentQuestionIndex + 1} von 10</span>
                            <div class="w-32 h-2 bg-slate-100 rounded-full overflow-hidden">
                                <div class="bg-blue-500 h-full transition-all duration-300" style="width: ${(state.currentQuestionIndex + 1) * 10}%"></div>
                            </div>
                        </div>
                        <div class="text-center py-12">
                            <div class="text-6xl font-bold text-slate-800 mb-8 flex justify-center items-center gap-4">
                                <span>${q.a}</span>
                                <span class="text-blue-500">${q.op === '*' ? 'Ã—' : (q.op === '/' ? 'Ã·' : q.op)}</span>
                                <span>${q.b}</span>
                                <span class="text-slate-300">=</span>
                            </div>
                            <input type="number" id="answerInput" autofocus class="text-4xl w-40 text-center border-b-4 border-blue-200 focus:border-blue-500 outline-none pb-2" placeholder="?">
                        </div>
                        <button onclick="submitAnswer()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl transition-colors text-xl">BestÃ¤tigen</button>
                    </div>
                `;
                document.getElementById('answerInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') submitAnswer();
                });
            } else if (state.view === 'result') {
                const percentage = (state.score / 10) * 100;
                app.innerHTML = `
                    <div class="p-8 text-center">
                        <h2 class="text-3xl font-bold text-slate-800 mb-4">Ergebnis</h2>
                        <div class="inline-block p-8 rounded-full bg-slate-50 mb-6 border-4 ${percentage >= 80 ? 'border-emerald-500' : 'border-amber-400'}">
                            <span class="text-5xl font-black text-slate-800">${state.score} / 10</span>
                        </div>
                        <p class="text-lg text-slate-600 mb-8">
                            ${percentage === 100 ? 'Perfekt! Du bist ein Mathe-Profi! ðŸ†' : (percentage >= 70 ? 'Super gemacht! Weiter so! âœ¨' : 'Gut probiert! Ãœbe weiter. ðŸ’ª')}
                        </p>
                        <div class="space-y-3 mb-8 text-left max-h-60 overflow-y-auto p-4 bg-slate-50 rounded-xl text-sm">
                            ${state.userAnswers.map((ua, idx) => `
                                <div class="flex justify-between border-b border-slate-200 py-1">
                                    <span>${ua.q} = ${ua.correct}</span>
                                    <span class="${ua.isCorrect ? 'text-emerald-600' : 'text-rose-600'}">${ua.isCorrect ? 'âœ”' : 'Dein Ergebnis: ' + ua.user}</span>
                                </div>
                            `).join('')}
                        </div>
                        <button onclick="resetGame()" class="w-full bg-slate-800 hover:bg-black text-white font-bold py-4 rounded-xl transition-colors text-xl">Nochmals spielen</button>
                    </div>
                `;
            }
        }

        function startGame(grade) {
            state.grade = grade;
            state.questions = generateQuestions(grade);
            state.currentQuestionIndex = 0;
            state.score = 0;
            state.userAnswers = [];
            state.view = 'game';
            render();
        }

        function submitAnswer() {
            const input = document.getElementById('answerInput');
            const val = parseInt(input.value);
            if (isNaN(val)) return;

            const q = state.questions[state.currentQuestionIndex];
            const isCorrect = val === q.ans;
            
            if (isCorrect) state.score++;
            
            state.userAnswers.push({
                q: `${q.a} ${q.op} ${q.b}`,
                user: val,
                correct: q.ans,
                isCorrect: isCorrect
            });

            if (state.currentQuestionIndex < 9) {
                state.currentQuestionIndex++;
                render();
            } else {
                state.view = 'result';
                render();
            }
        }

        function resetGame() {
            state.view = 'start';
            render();
        }

        // Initialer Render
        render();
    </script>
</body>
</html>
